<Window x:Class="OracleOptimizer.Views.MainView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:OracleOptimizer.ViewModels"
        mc:Ignorable="d"
        Title="Oracle SQL Optimizer" Height="700" Width="900" MinHeight="600" MinWidth="700">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- Row 0: Connection String -->
            <RowDefinition Height="*"/>    <!-- Row 1: Original SQL -->
            <RowDefinition Height="Auto"/>  <!-- Row 2: Analyze Button -->
            <RowDefinition Height="2*"/>   <!-- Row 3: Results TabControl -->
            <RowDefinition Height="Auto"/>  <!-- Row 4: StatusBar -->
            <RowDefinition Height="Auto"/>  <!-- Row 5: Save Button -->
        </Grid.RowDefinitions>

        <!-- Row 0: Connection String and API Key -->
        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Label Grid.Column="0" Content="Oracle Connection String:" VerticalAlignment="Center"/>
                <TextBox Grid.Column="1" x:Name="ConnectionStringTextBox" Text="{Binding ConnectionString, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" Margin="5,0" ToolTip="Enter connection string in EZConnect format: hostname:port/service_name"/>
                <!-- Connect button is optional, not implemented in ViewModel command -->
                <Button Grid.Column="2" Content="Connect" Margin="5,0" Padding="10,2" IsEnabled="False"/>
            </Grid>
            <Grid Margin="0,5,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Label Grid.Column="0" Content="Gemini API Key:" VerticalAlignment="Center"/>
                <TextBox Grid.Column="1" x:Name="GeminiApiKeyTextBox" Text="{Binding GeminiApiKey, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" Margin="5,0" ToolTip="Enter your Google Gemini API Key here."/>
            </Grid>
        </StackPanel>

        <!-- Row 1: Original SQL Input -->
        <Grid Grid.Row="1" Margin="0,5,0,5">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Label Grid.Row="0" Content="Original SQL Script:" FontWeight="SemiBold"/>
            <TextBox Grid.Row="1" x:Name="OriginalSqlTextBox"
                     Text="{Binding OriginalSql, UpdateSourceTrigger=PropertyChanged}"
                     AcceptsReturn="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                     FontFamily="Consolas" FontSize="12" Margin="0,2,0,0"/>
        </Grid>

        <!-- Row 2: Analyze Button -->
        <Button Grid.Row="2" Content="Analyze &amp; Optimize"
                Command="{Binding AnalyzeAndOptimizeCommand}"
                HorizontalAlignment="Stretch" Margin="0,5" Padding="0,8" FontWeight="Bold"/>

        <!-- Row 3: Results TabControl -->
        <TabControl Grid.Row="3" Margin="0,5">
            <TabItem Header="Optimized SQL">
                <TextBox Text="{Binding OptimizedSql, Mode=OneWay}" IsReadOnly="True"
                         AcceptsReturn="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                         FontFamily="Consolas" FontSize="12" Background="#FFF0F0F0"/>
            </TabItem>
            <TabItem Header="Gemini Report">
                <TextBox Text="{Binding GeminiReport, Mode=OneWay}" IsReadOnly="True"
                         AcceptsReturn="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                         TextWrapping="Wrap" Background="#FFF0F0F0"/>
            </TabItem>
            <TabItem Header="Validation Details">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <TextBlock Text="{Binding ValidationDetails, Mode=OneWay}" TextWrapping="Wrap" Margin="5"/>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="Performance">
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <TextBlock Text="{Binding PerformanceReport, Mode=OneWay}" Margin="5" FontFamily="Consolas"/>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Row 4: StatusBar -->
        <StatusBar Grid.Row="4" Margin="0,5,0,0">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusBarText, Mode=OneWay}"/>
            </StatusBarItem>
        </StatusBar>

        <!-- Row 5: Save Button -->
        <Button Grid.Row="5" Content="Save Script &amp; Report"
                Command="{Binding SaveScriptAndReportCommand}"
                IsEnabled="{Binding IsSaveEnabled}"
                HorizontalAlignment="Right" Margin="0,10,0,0" Padding="10,5"/>
    </Grid>
</Window>
